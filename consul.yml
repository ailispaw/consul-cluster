consul: &consul
  image: gliderlabs/consul
  ports:
    - 8300:8300     # Server RPC, Server Use Only
    - 8301:8301/tcp # Serf Gossip Protocol for LAN
    - 8301:8301/udp # Serf Gossip Protocol for LAN
    - 8302:8302/tcp # Serf Gossip Protocol for WAN, Server Use Only
    - 8302:8302/udp # Serf Gossip Protocol for WAN, Server Use Only
    - 8400:8400     # CLI RPC
    - 8500:8500     # HTTP API & Web UI
    - 8600:8600/tcp # DNS Interface
    - 8600:8600/udp # DNS Interface
  entrypoint: /bin/sh

bootstrap: &bootstrap
  <<: *consul
  command:
    - -c
    - /bin/consul agent -server -bootstrap -advertise=${NODE_IP} -data-dir=/tmp/consul -client=0.0.0.0 -ui -log-level=debug

node-01:
  <<: *bootstrap
